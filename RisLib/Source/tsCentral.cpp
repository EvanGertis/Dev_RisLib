//******************************************************************************
//******************************************************************************
//******************************************************************************

#include "stdafx.h"

#include <stdarg.h>

#include "my_functions.h"
#include "risAlphaDir.h"
#include "tsCentral.h"

namespace TS
{

//******************************************************************************
//******************************************************************************
//******************************************************************************
// Regional variables

static const int cMaxStringSize = 400;

// Program log file.
char rProgramName[cMaxStringSize];
FILE* rLogFile;


// Thread local storage.
static thread_local ThreadLocal* gThreadLocal;

//******************************************************************************
//******************************************************************************
//******************************************************************************

void reset()
{
   strcpy(rProgramName, "SomeProgram");
}

void setProgramName(const char* aName)
{
   strncpy(rProgramName, aName, cMaxStringSize);
}

//***************************************************************************
//***************************************************************************
//***************************************************************************
// Access to thread local storage.

// Return a pointer to the thread local storage.
void setThreadLocal(ThreadLocal* aThreadLocal)
{
   gThreadLocal = aThreadLocal;
}

ThreadLocal* local()
{
   return gThreadLocal;
}

//******************************************************************************
//******************************************************************************
//******************************************************************************

bool openFile()
{            
   char tBuf[400];
   char tFileName[400];
   strcpy(tFileName, rProgramName);
   strcat(tFileName,".txt");

   rLogFile = fopen(Ris::getAlphaFilePath_Log(tBuf,tFileName),"w");

   if (rLogFile==0)
   {
      return false;
   }

   return true;
}

//******************************************************************************
//******************************************************************************
//******************************************************************************

void closeFile()
{            
   if (rLogFile != 0)
   {
      fclose(rLogFile);
   }
   rLogFile=0;
}

//******************************************************************************
//******************************************************************************
//******************************************************************************
} //namespace

